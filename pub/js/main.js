"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}var localURL="http://localhost/courses_api/api.php",publicURL="http://studenter.miun.se/~yage1800/dt173g/course_api/api.php",courses=[];function addCourse(e){e.preventDefault();var t=document.querySelector("#code").value,s=document.querySelector("#name").value,o=document.querySelector("#progression").value,r=document.querySelector("#syllabus").value;if(0===t.trim().length||0===s.trim().length||0===o.trim().length||0===r.trim().length)return document.querySelector(".message").classList.add("error-message"),document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").textContent="Alla fälten måste fyllas i.",void document.querySelector(".message").classList.add("show");var c={code:t,name:s,progression:o,syllabus:r};fetch(publicURL,{method:"post",body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){document.querySelector(".message").classList.remove("error-message"),document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add(e.class),document.querySelector(".message").textContent=e.message,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3),clearFields(),fetchCourses()})).catch((function(e){document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add("error-message"),document.querySelector(".message").textContent=e,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3)}))}function fetchCourses(){document.querySelector("tbody").innerHTML="",fetch(publicURL,{method:"get"}).then((function(e){return e.json()})).then((function(e){e instanceof Array?(courses=_toConsumableArray(e),document.querySelector("table").style.display="table",courses.forEach((function(e){document.querySelector("tbody").innerHTML+="\n                <td>".concat(e.code,"</td>\n                <td>").concat(e.name,"</td>\n                <td>").concat(e.progression,'</td>\n                <td><a href="').concat(e.syllabus,'" target="_blank">Länk</a></td>\n                <td>\n                <i class="fas fa-edit edit-icon" onClick="openUpdateModal(').concat(e.id,')"></i>\n                <i class="fas fa-trash-alt delete-icon" onClick="deleteCourse(').concat(e.id,')"></i>\n                </td>\n                ')}))):(document.querySelector("table").style.display="none",document.querySelector(".output").textContent=e.message)})).catch((function(e){document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add("error-message"),document.querySelector(".message").textContent=e,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3)}))}function updateCourse(e){e.preventDefault();var t=document.querySelector("#update-code").value,s=document.querySelector("#update-name").value,o=document.querySelector("#update-progression").value,r=document.querySelector("#update-syllabus").value,c=document.querySelector("#update-btn").dataset.id;if(0===t.trim().length||0===s.trim().length||0===o.trim().length||0===r.trim().length)return document.querySelector(".message").classList.add("error-message"),document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").textContent="Alla fälten måste fyllas i.",void document.querySelector(".message").classList.add("show");var a={code:t,name:s,progression:o,syllabus:r,id:c};fetch(publicURL,{method:"put",body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){document.querySelector(".message").classList.remove("error-message"),document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add(e.class),document.querySelector(".message").textContent=e.message,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3),clearFields(),closeUpdateModal(),fetchCourses()})).catch((function(e){document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add("error-message"),document.querySelector(".message").textContent=e,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3)}))}function deleteCourse(e){fetch(publicURL,{method:"delete",body:JSON.stringify({id:e})}).then((function(e){return e.json()})).then((function(e){document.querySelector(".message").classList.remove("error-message"),document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add(e.class),document.querySelector(".message").textContent=e.message,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3),clearFields(),closeUpdateModal(),fetchCourses()})).catch((function(e){document.querySelector(".message").classList.remove("success-message"),document.querySelector(".message").classList.add("error-message"),document.querySelector(".message").textContent=e,document.querySelector(".message").classList.add("show"),setTimeout((function(){document.querySelector(".message").classList.remove("show")}),4e3)}))}function clearFields(){document.querySelector("#code").value="",document.querySelector("#name").value="",document.querySelector("#syllabus").value="",document.querySelector("#update-code").value="",document.querySelector("#update-name").value="",document.querySelector("#update-progression").value="",document.querySelector("#update-syllabus").value=""}function openUpdateModal(e){document.querySelector(".backdrop").style.display="block",document.querySelector(".modal").style.transform="translate(-50%, -50%)";var t=courses.find((function(t){return t.id==e}));document.querySelector("#update-btn").dataset.id=e,document.querySelector("#update-code").value=t.code,document.querySelector("#update-name").value=t.name,document.querySelector("#update-progression").value=t.progression,document.querySelector("#update-syllabus").value=t.syllabus}function closeUpdateModal(){document.querySelector(".backdrop").style.display="none",document.querySelector(".modal").style.transform="translate(-50%, -150vh)"}window.addEventListener("load",fetchCourses),document.querySelector(".form").addEventListener("submit",addCourse),document.querySelector(".update-form").addEventListener("submit",updateCourse),document.querySelector(".backdrop").addEventListener("click",closeUpdateModal),document.querySelector(".close").addEventListener("click",closeUpdateModal);